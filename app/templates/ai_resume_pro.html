{% extends "base.html" %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/ai_resume_pro.css') }}">
{% endblock %}

{% block content %}
<div class="resume-pro-layout">

    <aside id="resume-history-sidebar" class="resume-history-sidebar">
        <div class="sidebar-header">
            <h3>Riwayat & Aksi</h3>
        </div>
        <div class="sidebar-actions">
            <button id="new-analysis-btn" class="button-primary full-width">Analisis CV Baru</button>
        </div>
        <div id="saved-resumes-list" class="saved-resumes-list">
            {% if saved_resumes %}
                {% for resume in saved_resumes %}
                    <div class="resume-item-wrapper">
                        <a href="#" class="resume-item" data-id="{{ resume.id }}">
                            <span class="filename">{{ resume.original_filename }}</span>
                            <span class="timestamp">{{ resume.created_at.strftime('%d %b %Y, %H:%M') }}</span>
                        </a>
                        <div class="generated-cv-action" id="action-container-{{ resume.id }}"></div>
                    </div>
                {% endfor %}
            {% else %}
                <p class="empty-list-text">Belum ada resume yang disimpan.</p>
            {% endif %}
        </div>
    </aside>

    <main class="resume-pro-main">
        <div class="main-header">
            <h1 id="main-title">AI Resume Pro</h1>
            <div id="main-actions" class="main-actions">
                </div>
        </div>

        <div id="main-content-area" class="main-content-area">
            <div id="upload-box" class="upload-box">
                <input type="file" id="pdf-upload-input" accept=".pdf" hidden/>
                <label for="pdf-upload-input" class="upload-label">
                    <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
                    <span class="upload-text">Klik untuk Mengunggah atau Seret File PDF ke Sini</span>
                    <span class="upload-hint">Ukuran file maksimal 5MB</span>
                </label>
            </div>

            <div id="review-container" class="review-container" style="display: none;">
                <div class="panel resume-display-panel"><h3>Teks CV Anda</h3><pre id="resume-content-text"></pre></div>
                <div class="panel feedback-panel"><h3>Feedback AI</h3><div id="feedback-content" class="feedback-content"></div></div>
            </div>

            <div id="template-selection-box" class="template-selection-box" style="display: none;">
                <h2>Pilih Template Profesional</h2>
                <p>Pilih salah satu desain di bawah ini. Kami akan secara otomatis mengisinya dengan data dari CV Anda.</p>
                <div class="template-grid">
                    <div class="template-card" data-template="modern">
                        <img src="{{ url_for('static', filename='images/template-modern.png') }}" alt="Modern Template Preview">
                        <h4>Modern</h4>
                    </div>
                    <div class="template-card" data-template="classic">
                        <img src="{{ url_for('static', filename='images/template-classic.png') }}" alt="Classic Template Preview">
                        <h4>Classic</h4>
                    </div>
                    <div class="template-card" data-template="creative">
                        <img src="{{ url_for('static', filename='images/template-creative.png') }}" alt="Creative Template Preview">
                        <h4>Creative</h4>
                    </div>
                </div>
            </div>

            <div id="resume-preview-box" class="resume-preview-box" style="display: none;">
                </div>
            
            <div id="loading-spinner" class="spinner-container" style="display: none;">
                <div class="spinner-content"><div class="spinner"></div><p>Farmile sedang menganalisis CV-mu...</p></div>
            </div>
        </div>
    </main>
</div>
{% endblock %}

{% block scripts %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="{{ url_for('static', filename='js/ai_resume_pro.js') }}"></script>
{% endblock %}